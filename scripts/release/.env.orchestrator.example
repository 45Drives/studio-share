# --------------------------
# General
# --------------------------
# Always derived from package.json version (set by orchestrator).
RELEASE_VERSION=
RELEASE_TAG=v__VERSION__
RELEASE_STAGING_DIR=./builds/release/__VERSION__
RELEASE_BUILDS_DIR=./release-builds

# --------------------------
# Linux build (local machine)
# --------------------------
RUN_LINUX_BUILD=1
LINUX_GIT_PULL_CMD="git pull --ff-only"
LINUX_BUILD_CMD="yarn build:linux"
LINUX_CLEAN_OUTPUTS=1

# --------------------------
# Windows build + sign (remote over SSH)
# --------------------------
RUN_WINDOWS_BUILD=1
WIN_PHASE=stage
# WIN_PHASE options:
# - stage: build -> upload unsigned, then stop for manual GUI signing
# - finalize: skip build, fetch signed exe/blockmap back to release-builds

# Build host (where repo already exists and build runs)
WIN_BUILD_HOST=10.20.0.124
WIN_BUILD_PORT=22
WIN_BUILD_USER='45RD Testing'
WIN_BUILD_PASSWORD=
WIN_BUILD_REMOTE_DIR=studio-share

# Build mode:
# - git: SSH in and run git pull + build in existing repo
# - rsync: sync this local repo to remote and build there
WIN_BUILD_MODE=git
WIN_BUILD_GIT_PULL_CMD="cd studio-share && git pull --ff-only"
WIN_BUILD_CMD="cd studio-share && yarn install && yarn build:win"
WIN_BUILD_DIST_DIR="studio-share/dist/"
# Legacy fallback (not used when WIN_BUILD_DIST_DIR is set):
WIN_BUILD_EXE_GLOB="studio-share/dist/*-win-*.exe"
WIN_BUILD_DISABLE_SIGN=1
# Optional override when WIN_BUILD_DISABLE_SIGN=1 (cmd.exe syntax):
# WIN_BUILD_NO_SIGN_PREFIX='set CSC_IDENTITY_AUTO_DISCOVERY=false&& set CSC_LINK=&& set CSC_KEY_PASSWORD=&& set WIN_CSC_LINK=&& set WIN_CSC_KEY_PASSWORD=&& set CSC_NAME=&& set WIN_CSC_NAME=&& '
# Optional override when WIN_BUILD_CMD is not cmd.exe /c:
# WIN_BUILD_NO_SIGN_PREFIX_POSIX='CSC_IDENTITY_AUTO_DISCOVERY=false CSC_LINK= CSC_KEY_PASSWORD= WIN_CSC_LINK= WIN_CSC_KEY_PASSWORD= CSC_NAME= WIN_CSC_NAME= '

# Optional when WIN_BUILD_MODE=rsync
WIN_BUILD_PREPARE_CMD=

# Manual signing folder on the same Windows build host.
WIN_SIGN_WIN_DIR='C:\Users\45RD Testing\Downloads\Studio Share Signing'

# --------------------------
# mac build chain
# Linux orchestrator -> ARM Mac build -> Intel Mac sign/notarize
# --------------------------
RUN_MAC_BUILD=1

MAC_ARM_HOST=192.168.209.29
MAC_ARM_PORT=22
MAC_ARM_USER=45drives
MAC_ARM_PASSWORD=
MAC_ARM_REPO_DIR=/studio-share
# Build mode: arm64 | x64 | universal | both
MAC_BUILD_KIND=universal

# Optional: local file copied to ARM repo before build.
# Useful when you keep release/sign config locally.
MAC_RELEASE_ENV_LOCAL=
MAC_RELEASE_ENV_REMOTE=/studio-share/scripts/.env.release
MAC_ARM_GIT_PULL_CMD="cd '/studio-share' && git pull --ff-only"

# Optional explicit remote command. Supports:
# - __BUNDLE_TAG__ placeholder
# - __ENV_FILE__ placeholder (when MAC_RELEASE_ENV_LOCAL is set)
MAC_REMOTE_CMD="cd '/studio-share' && BUNDLE_TAG_OVERRIDE='__BUNDLE_TAG__' ENV_FILE='__ENV_FILE__' bash /studio-share/scripts/release-mac-build.sh"

# Pull signed artifacts back from ARM host (after release-mac-build.sh syncs them there).
MAC_FETCH_HOST=192.168.209.29
MAC_FETCH_PORT=22
MAC_FETCH_USER=45drives
MAC_FETCH_PASSWORD=
MAC_FETCH_DIR=/studio-share/mac-signing-out/__BUNDLE_TAG__/
# MAC_FETCH_CLEANUP_OLD=1
# MAC_FETCH_KEEP_COUNT=20
# MAC_FETCH_CLEANUP_GLOB=mac-*

# Legacy fallback (if you fetch directly from Intel signer instead of ARM):
# MAC_SIGN_OUTPUT_DIR=/Users/intel_signer/signing-output

# --------------------------
# GitHub release automation (optional)
# --------------------------
GH_REPO=45Drives/studio-share
GH_CREATE_DRAFT=1
GH_UPLOAD_RELEASE=1
GH_PUBLISH_RELEASE=0
GH_TITLE=v__VERSION__
GH_NOTES=
